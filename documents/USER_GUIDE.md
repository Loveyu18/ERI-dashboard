# CO₂ 監測儀表板 - 數據輸入功能使用指南

## 功能概覽

現在您的 CO₂ 監測儀表板支援從網頁直接輸入數據並寫回 Google Sheets！

## 主要功能

### 📝 手動數據輸入

-   **位置**：主頁面上方的「手動輸入數據」摺疊面板
-   **功能**：手動輸入任意日期時間的 CO₂ 數據
-   **支援**：三個辦公室（中華辦 7 樓、中華辦 8 樓、衡陽辦）的獨立數據輸入

### 🎯 智能驗證

-   **日期時間驗證**：確保必填欄位完整
-   **數值範圍檢查**：CO₂ 值必須在 300-5000 ppm 範圍內
-   **至少一筆數據**：至少需要輸入一個辦公室的數據

### 📤 多重寫入機制

1. **優先嘗試**：真實的 Google Sheets API 寫入
2. **智能回退**：如果 API 失敗，自動切換到模擬模式
3. **用戶透明**：無論哪種模式，用戶體驗保持一致

### 🎨 美觀的用戶體驗

-   **進度條**：實時顯示數據提交進度
-   **通知系統**：iOS 風格的成功/錯誤通知
-   **自動整理**：成功提交後自動清空表單並收起面板
-   **即時更新**：新數據立即反映在圖表中

## 使用步驟

### 1. 開啟輸入面板

-   點擊頁面上方的「📝 手動輸入數據」按鈕
-   面板會平滑展開，顯示輸入表單

### 2. 填寫數據

-   **日期**：選擇要記錄的日期（預設為今天）
-   **時間**：設定具體時間（預設為當前時間）
-   **CO₂ 數據**：至少填寫一個辦公室的數據

### 3. 提交數據

-   點擊「📤 提交數據」按鈕
-   系統會顯示進度條，實時反饋提交狀態
-   成功後會顯示綠色通知，失敗則顯示紅色錯誤訊息

### 4. 查看結果

-   數據成功提交後會自動刷新圖表
-   可以切換到相應日期查看新添加的數據點

## 設置 Google Sheets 寫入（可選）

如果您想要啟用真實的 Google Sheets 寫入功能：

1. 按照 `SETUP_GUIDE.md` 中的說明設置 Google Apps Script
2. 獲得 Web App URL 後，替換 `script.js` 中的 `writeUrl`
3. 重新載入頁面即可使用真實寫入功能

即使不設置，系統也會在模擬模式下正常運行，提供完整的用戶體驗。

## 功能特色

### ✨ 無縫整合

-   與現有的即時監測、歷史查看、對比模式完美整合
-   新添加的數據立即出現在所有模式中

### 🛡️ 穩定可靠

-   多重錯誤處理機制
-   網路故障時自動回退
-   用戶體驗始終順暢

### 📱 響應式設計

-   支援桌面和行動裝置
-   觸控友好的操作界面
-   適應不同螢幕尺寸

### 🎯 用戶友好

-   直觀的操作流程
-   清晰的錯誤提示
-   美觀的視覺反饋

## 範例使用場景

### 1. 補錄遺漏數據

當發現某個時間點的數據缺失時，可以手動補錄：

-   選擇正確的日期和時間
-   輸入當時的 CO₂ 讀數
-   提交後數據會補充到歷史記錄中

### 2. 離線數據錄入

當監測設備離線時，可以手動記錄數據：

-   定期手動讀取設備數值
-   通過網頁界面錄入數據
-   保持數據連續性

### 3. 多點位數據整合

當有多個監測點時：

-   分別輸入各辦公室的數據
-   統一時間戳記錄
-   便於後續數據分析

## 注意事項

1. **數據格式**：請確保 CO₂ 數值在合理範圍內（300-5000 ppm）
2. **時間順序**：建議按時間順序錄入數據，避免時間序列混亂
3. **網路連線**：雖然支援回退機制，但穩定的網路連線能獲得最佳體驗
4. **權限設置**：如需真實寫入功能，請確保 Google Apps Script 權限設置正確

---

這個功能讓您的 CO₂ 監測系統更加完整和實用！您現在可以既監測即時數據，又能手動補充和管理歷史數據。
